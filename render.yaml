version: 1
services:
  - type: web
    name: invidious
    env: bash
    buildCommand: |
      # 必要なパッケージのインストール
      apt-get update
      apt-get install -y crystal shards
      shards install  # 依存関係のインストール
      crystal build src/invidious.cr --release  # ビルド
    startCommand: |
      ./invidious -b 0.0.0.0 -p $PORT  # サーバーの起動
    plan: free
    healthCheckPath: /
